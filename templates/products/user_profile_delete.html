{% extends "base.html" %}
{% load static %}

{% block title %}X√≥a H·ªì S∆° - Fitblog{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <div class="card shadow-lg border-danger">
                <!-- Header -->
                <div class="card-header bg-danger text-white text-center py-4">
                    <h1 class="card-title h4 mb-1">‚ö†Ô∏è X√≥a H·ªì S∆° Vƒ©nh Vi·ªÖn</h1>
                    <p class="text-light mb-0">H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ƒë∆∞·ª£c ho√†n t√°c</p>
                </div>

                <!-- Body -->
                <div class="card-body p-4">
                    <!-- Warning Alert -->
                    <div class="alert alert-danger" role="alert">
                        <h5 class="alert-heading">üö® C·∫£nh b√°o!</h5>
                        <p>B·∫°n s·∫Øp x√≥a h·ªì s∆° c√° nh√¢n v√† to√†n b·ªô d·ªØ li·ªáu li√™n quan:</p>
                        <ul class="mb-0">
                            <li><strong>Session ID:</strong> {{ user_profile.session_id|truncatechars:20 }}</li>
                            <li><strong>Tu·ªïi:</strong> {{ user_profile.age }} tu·ªïi</li>
                            <li><strong>C√¢n n·∫∑ng:</strong> {{ user_profile.weight_kg|floatformat:1 }} kg</li>
                            <li><strong>Chi·ªÅu cao:</strong> {{ user_profile.height_cm|floatformat:1 }} cm</li>
                            <li><strong>M·ª•c ti√™u:</strong> {{ user_profile.get_goal_display }}</li>
                            <li><strong>L·ªãch s·ª≠ g·ª£i √Ω:</strong> {{ recommendation_count }} records</li>
                        </ul>
                    </div>

                    <!-- Info Box -->
                    <div class="alert alert-info" role="alert">
                        <strong>‚ÑπÔ∏è Th√¥ng Tin Quan Tr·ªçng</strong>
                        <ul class="mb-0 mt-2">
                            <li>Session hi·ªán t·∫°i s·∫Ω b·ªã x√≥a</li>
                            <li>To√†n b·ªô l·ªãch s·ª≠ g·ª£i √Ω s·∫Ω b·ªã x√≥a</li>
                            <li>B·∫°n s·∫Ω ph·∫£i setup l·∫°i h·ªì s∆° n·∫øu mu·ªën d√πng ti·∫øp</li>
                            <li>L·∫ßn truy c·∫≠p ti·∫øp theo s·∫Ω t·∫°o session v√† h·ªì s∆° m·ªõi</li>
                        </ul>
                    </div>

                    <!-- Form -->
                    <form method="post" novalidate>
                        {% csrf_token %}
                        
                        <!-- Confirmation text -->
                        <div class="mb-4">
                            <label for="confirm_text" class="form-label fw-bold">
                                ƒê·ªÉ x√≥a, vui l√≤ng nh·∫≠p: <code>X√ìA H·ªíNG S∆†</code>
                            </label>
                            <input 
                                type="text" 
                                id="confirm_text"
                                name="confirm_text"
                                class="form-control"
                                placeholder="G√µ ch√≠nh x√°c: X√ìA H·ªíNG S∆†"
                                required
                            >
                            <small class="text-muted d-block mt-1">
                                ƒêi·ªÅu n√†y ƒë·ªÉ tr√°nh x√≥a v√¥ t√¨nh
                            </small>
                        </div>

                        <!-- Buttons -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                            <button type="submit" class="btn btn-danger btn-lg">
                                üóëÔ∏è X√≥a H·ªì S∆° Vƒ©nh Vi·ªÖn
                            </button>
                            <a href="{% url 'products:user_profile_view' %}" class="btn btn-outline-secondary btn-lg">
                                ‚Üê H·ªßy
                            </a>
                        </div>
                    </form>
                </div>

                <!-- Footer -->
                <div class="card-footer bg-light text-center py-3">
                    <small class="text-danger">
                        <strong>C·∫£nh b√°o:</strong> B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ti·∫øp t·ª•c kh√¥ng?
                    </small>
                </div>
            </div>

            <!-- Alternative: Reset Option -->
            <div class="mt-4 text-center">
                <p class="text-muted">
                    <strong>Kh√¥ng mu·ªën x√≥a ho√†n to√†n?</strong>
                </p>
                <p>
                    <a href="{% url 'products:user_profile_reset' %}" class="btn btn-outline-warning">
                        üîÑ Reset H·ªì S∆° (Gi·ªØ Session)
                    </a>
                </p>
                <small class="text-muted">
                    Reset s·∫Ω x√≥a th√¥ng tin nh∆∞ng gi·ªØ l·∫°i session, b·∫°n c√≥ th·ªÉ setup l·∫°i
                </small>
            </div>
        </div>
    </div>
</div>

<!-- CSS -->
<style>
    .card {
        border-width: 2px;
    }

    .btn-danger {
        background-color: #dc3545;
    }

    .btn-danger:hover {
        background-color: #c82333;
        transform: scale(1.02);
    }

    .text-danger {
        color: #dc3545 !important;
    }
</style>

<!-- JavaScript: Validation -->
<script>
document.querySelector('form').addEventListener('submit', function(e) {
    const input = document.getElementById('confirm_text').value.trim();
    if (input !== 'X√ìA H·ªíNG S∆†') {
        e.preventDefault();
        alert('‚ùå Vui l√≤ng nh·∫≠p ch√≠nh x√°c: X√ìA H·ªíNG S∆†');
        return false;
    }
});
</script>
{% endblock %}
